2023-10-24 | 10:33:45.880 | INFO  | [main] | o.s.t.c.s.DefaultTestContextBootstrapper (AbstractTestContextBootstrapper.java:305) | Neither @ContextConfiguration nor @ContextHierarchy found for test class [codesmell.test.CamelKafkaOffsetTest], using DelegatingSmartContextLoader
2023-10-24 | 10:33:45.889 | INFO  | [main] | o.s.t.c.s.AbstractContextLoader (AbstractContextLoader.java:264) | Could not detect default resource locations for test class [codesmell.test.CamelKafkaOffsetTest]: no resource found for suffixes {-context.xml}.
2023-10-24 | 10:33:45.891 | INFO  | [main] | o.s.t.c.s.AnnotationConfigContextLoaderUtils (AnnotationConfigContextLoaderUtils.java:83) | Could not detect default configuration classes for test class [codesmell.test.CamelKafkaOffsetTest]: CamelKafkaOffsetTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-10-24 | 10:33:46.023 | INFO  | [main] | o.s.t.c.s.DefaultTestContextBootstrapper (AbstractTestContextBootstrapper.java:245) | Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.event.ApplicationEventsTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener, org.springframework.test.context.event.EventPublishingTestExecutionListener, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener, org.springframework.boot.test.autoconfigure.webservices.client.MockWebServiceServerTestExecutionListener]
2023-10-24 | 10:33:46.043 | INFO  | [main] | o.s.t.c.s.DefaultTestContextBootstrapper (AbstractTestContextBootstrapper.java:174) | Using TestExecutionListeners: [org.apache.camel.test.spring.junit5.CamelSpringTestContextLoaderTestExecutionListener@1a7288a3, org.apache.camel.test.spring.junit5.CamelSpringBootExecutionListener@2974f221, org.apache.camel.test.spring.junit5.StopWatchTestExecutionListener@58fe0499, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@686449f9, org.springframework.test.context.event.ApplicationEventsTestExecutionListener@665df3c6, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener@68b6f0d6, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@4044fb95, org.springframework.test.context.support.DirtiesContextTestExecutionListener@aa549e5, org.springframework.test.context.transaction.TransactionalTestExecutionListener@36f48b4, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@5c00384f, org.springframework.test.context.event.EventPublishingTestExecutionListener@3b7ff809, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener@1bb564e2, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener@62e6b5c8, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener@3f792b9b, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener@7b8233cd, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener@4b20ca2b, org.springframework.boot.test.autoconfigure.webservices.client.MockWebServiceServerTestExecutionListener@1cbf6e72]
2023-10-24 | 10:33:46.576 | INFO  | [main] | k.utils.Log4jControllerRegistration$ (Log4jControllerRegistration$.java:31) | Registered kafka:type=kafka.Log4jController MBean
2023-10-24 | 10:33:47.052 | WARN  | [main] | o.a.z.server.ServerCnxnFactory (ServerCnxnFactory.java:309) | maxCnxns is not configured, using default value 0.
2023-10-24 | 10:33:48.059 | WARN  | [main] | k.server.BrokerMetadataCheckpoint (Logging.java:70) | No meta.properties file under dir /var/folders/82/qc43__sx1qg1wqrtl2csq6r80000gq/T/spring.kafka.eecf13e6-dbbb-46f9-a367-ee5d314620db2218659128864793012/meta.properties
2023-10-24 | 10:33:49.132 | INFO  | [/config/changes-event-process-thread] | k.c.ZkNodeChangeNotificationListener$ChangeEventProcessThread (Logging.java:66) | [/config/changes-event-process-thread]: Starting
2023-10-24 | 10:33:49.205 | INFO  | [main] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:33:49.209 | INFO  | [main] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:33:49.210 | INFO  | [main] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158029191
2023-10-24 | 10:33:49.277 | INFO  | [main] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:33:49.277 | INFO  | [main] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:33:49.277 | INFO  | [main] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158029277
2023-10-24 | 10:33:49.290 | INFO  | [kafka-admin-client-thread | adminclient-1] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser.java:83) | App info kafka.admin.client for adminclient-1 unregistered
2023-10-24 | 10:33:49.297 | INFO  | [kafka-admin-client-thread | adminclient-1] | o.a.k.c.a.i.AdminMetadataManager (AdminMetadataManager.java:235) | [AdminClient clientId=adminclient-1] Metadata update failed
org.apache.kafka.common.errors.TimeoutException: Timed out waiting to send the call. Call: fetchMetadata
2023-10-24 | 10:33:49.298 | INFO  | [kafka-admin-client-thread | adminclient-1] | o.a.k.clients.admin.KafkaAdminClient (KafkaAdminClient$AdminClientRunnable.java:1346) | [AdminClient clientId=adminclient-1] Timed out 1 remaining operation(s) during close.
2023-10-24 | 10:33:49.313 | INFO  | [kafka-admin-client-thread | adminclient-1] | o.a.kafka.common.metrics.Metrics (Metrics.java:659) | Metrics scheduler closed
2023-10-24 | 10:33:49.317 | INFO  | [kafka-admin-client-thread | adminclient-1] | o.a.kafka.common.metrics.Metrics (Metrics.java:663) | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2023-10-24 | 10:33:49.321 | INFO  | [kafka-admin-client-thread | adminclient-1] | o.a.kafka.common.metrics.Metrics (Metrics.java:669) | Metrics reporters closed
2023-10-24 | 10:33:53.417 | INFO  | [main] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:33:53.420 | INFO  | [main] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:33:53.421 | INFO  | [main] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158033415
2023-10-24 | 10:33:53.490 | INFO  | [kafka-producer-network-thread | producer-1] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Producer clientId=producer-1] Cluster ID: pImShM5YSgmKNguDY0e14g
2023-10-24 | 10:33:53.516 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 1
2023-10-24 | 10:33:53.632 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:33:53.633 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:33:53.633 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158033632
2023-10-24 | 10:33:53.633 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:33:53.633 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:33:53.633 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158033632
2023-10-24 | 10:33:53.637 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:33:53.643 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:966) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Subscribed to topic(s): foobarTopic
2023-10-24 | 10:33:53.643 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:966) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Subscribed to topic(s): foobarTopic
2023-10-24 | 10:33:53.644 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:33:53.644 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158033632
2023-10-24 | 10:33:53.645 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:966) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Subscribed to topic(s): foobarTopic
2023-10-24 | 10:33:53.696 | WARN  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Error while fetching metadata with correlation id 2 : {foobarTopic=UNKNOWN_TOPIC_OR_PARTITION}
2023-10-24 | 10:33:53.697 | WARN  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Error while fetching metadata with correlation id 2 : {foobarTopic=UNKNOWN_TOPIC_OR_PARTITION}
2023-10-24 | 10:33:53.696 | WARN  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Error while fetching metadata with correlation id 2 : {foobarTopic=UNKNOWN_TOPIC_OR_PARTITION}
2023-10-24 | 10:33:53.699 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Cluster ID: pImShM5YSgmKNguDY0e14g
2023-10-24 | 10:33:53.699 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Cluster ID: pImShM5YSgmKNguDY0e14g
2023-10-24 | 10:33:53.699 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Cluster ID: pImShM5YSgmKNguDY0e14g
2023-10-24 | 10:33:53.717 | WARN  | [kafka-producer-network-thread | producer-1] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Producer clientId=producer-1] Error while fetching metadata with correlation id 3 : {foobarTopic=LEADER_NOT_AVAILABLE}
2023-10-24 | 10:33:53.820 | WARN  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Error while fetching metadata with correlation id 4 : {foobarTopic=UNKNOWN_TOPIC_OR_PARTITION}
2023-10-24 | 10:33:53.820 | WARN  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Error while fetching metadata with correlation id 4 : {foobarTopic=UNKNOWN_TOPIC_OR_PARTITION}
2023-10-24 | 10:33:53.822 | WARN  | [kafka-producer-network-thread | producer-1] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Producer clientId=producer-1] Error while fetching metadata with correlation id 4 : {foobarTopic=UNKNOWN_TOPIC_OR_PARTITION}
2023-10-24 | 10:33:53.827 | WARN  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Error while fetching metadata with correlation id 4 : {foobarTopic=LEADER_NOT_AVAILABLE}
2023-10-24 | 10:33:53.926 | WARN  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Error while fetching metadata with correlation id 6 : {foobarTopic=UNKNOWN_TOPIC_OR_PARTITION}
2023-10-24 | 10:33:53.928 | WARN  | [kafka-producer-network-thread | producer-1] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Producer clientId=producer-1] Error while fetching metadata with correlation id 5 : {foobarTopic=UNKNOWN_TOPIC_OR_PARTITION}
2023-10-24 | 10:33:53.928 | WARN  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Error while fetching metadata with correlation id 6 : {foobarTopic=LEADER_NOT_AVAILABLE}
2023-10-24 | 10:33:53.931 | WARN  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Error while fetching metadata with correlation id 6 : {foobarTopic=LEADER_NOT_AVAILABLE}
2023-10-24 | 10:33:54.028 | WARN  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Error while fetching metadata with correlation id 8 : {foobarTopic=LEADER_NOT_AVAILABLE}
2023-10-24 | 10:33:54.031 | WARN  | [kafka-producer-network-thread | producer-1] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Producer clientId=producer-1] Error while fetching metadata with correlation id 6 : {foobarTopic=UNKNOWN_TOPIC_OR_PARTITION}
2023-10-24 | 10:33:54.034 | WARN  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Error while fetching metadata with correlation id 8 : {foobarTopic=LEADER_NOT_AVAILABLE}
2023-10-24 | 10:33:54.038 | WARN  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Error while fetching metadata with correlation id 8 : {foobarTopic=LEADER_NOT_AVAILABLE}
2023-10-24 | 10:33:54.137 | INFO  | [kafka-producer-network-thread | producer-1] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Producer clientId=producer-1] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.137 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.137 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.139 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.139 | INFO  | [kafka-producer-network-thread | producer-1] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Producer clientId=producer-1] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.140 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.141 | INFO  | [kafka-producer-network-thread | producer-1] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Producer clientId=producer-1] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.142 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.142 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.141 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.142 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.142 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.253 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 2
2023-10-24 | 10:33:54.285 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 3
2023-10-24 | 10:33:54.311 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 4
2023-10-24 | 10:33:54.318 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 5
2023-10-24 | 10:33:54.356 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> NORETRY-ERROR
2023-10-24 | 10:33:54.362 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 6
2023-10-24 | 10:33:54.366 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 7
2023-10-24 | 10:33:54.369 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> NORETRY-ERROR
2023-10-24 | 10:33:54.371 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 8
2023-10-24 | 10:33:54.375 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 9
2023-10-24 | 10:33:54.379 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 10
2023-10-24 | 10:33:54.380 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$FindCoordinatorResponseHandler.java:853) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Discovered group coordinator localhost:50591 (id: 2147483647 rack: null)
2023-10-24 | 10:33:54.382 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:33:54.386 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 11
2023-10-24 | 10:33:54.424 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Request joining group due to: need to re-join with the given member-id
2023-10-24 | 10:33:54.424 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:33:54.439 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Successfully joined group with generation Generation{generationId=1, memberId='consumer-test_group_id-2-ee4e9e33-2b35-435f-9f8c-7ca3ab3f8e58', protocol='range'}
2023-10-24 | 10:33:54.441 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:659) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Finished assignment for group at generation 1: {consumer-test_group_id-2-ee4e9e33-2b35-435f-9f8c-7ca3ab3f8e58=Assignment(partitions=[foobarTopic-0, foobarTopic-1, foobarTopic-2])}
2023-10-24 | 10:33:54.471 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$FindCoordinatorResponseHandler.java:853) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Discovered group coordinator localhost:50591 (id: 2147483647 rack: null)
2023-10-24 | 10:33:54.471 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$FindCoordinatorResponseHandler.java:853) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Discovered group coordinator localhost:50591 (id: 2147483647 rack: null)
2023-10-24 | 10:33:54.472 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:33:54.474 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:33:54.497 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Successfully synced group in generation Generation{generationId=1, memberId='consumer-test_group_id-2-ee4e9e33-2b35-435f-9f8c-7ca3ab3f8e58', protocol='range'}
2023-10-24 | 10:33:54.504 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-0, foobarTopic-1, foobarTopic-2])
2023-10-24 | 10:33:54.508 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-0, foobarTopic-1, foobarTopic-2
2023-10-24 | 10:33:54.513 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Request joining group due to: need to re-join with the given member-id
2023-10-24 | 10:33:54.513 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Request joining group due to: need to re-join with the given member-id
2023-10-24 | 10:33:54.513 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:33:54.513 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:33:54.532 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator$OffsetFetchResponseHandler.java:1405) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Found no committed offset for partition foobarTopic-0
2023-10-24 | 10:33:54.533 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator$OffsetFetchResponseHandler.java:1405) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Found no committed offset for partition foobarTopic-1
2023-10-24 | 10:33:54.533 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator$OffsetFetchResponseHandler.java:1405) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Found no committed offset for partition foobarTopic-2
2023-10-24 | 10:33:54.550 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.SubscriptionState (SubscriptionState.java:398) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Resetting offset for partition foobarTopic-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}.
2023-10-24 | 10:33:54.550 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.SubscriptionState (SubscriptionState.java:398) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Resetting offset for partition foobarTopic-1 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}.
2023-10-24 | 10:33:54.550 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.SubscriptionState (SubscriptionState.java:398) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Resetting offset for partition foobarTopic-2 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}.
2023-10-24 | 10:33:54.598 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 0:0
The Key is null
1
2023-10-24 | 10:33:54.601 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 0:0
The Key is null
1
2023-10-24 | 10:33:54.620 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 0:1
The Key is null
6
2023-10-24 | 10:33:54.621 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 0:1
The Key is null
6
2023-10-24 | 10:33:54.625 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 0:2
The Key is null
10
2023-10-24 | 10:33:54.626 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 0:2
The Key is null
10
2023-10-24 | 10:33:54.632 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 1:0
The Key is null
2
2023-10-24 | 10:33:54.633 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 1:0
The Key is null
2
2023-10-24 | 10:33:54.643 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 1:1
The Key is null
4
2023-10-24 | 10:33:54.643 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 1:1
The Key is null
4
2023-10-24 | 10:33:54.648 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 1:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:33:54.670 | ERROR | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | route2 (CamelLogger.java:163) | Having an unretryable issue due to NON RETRY ERROR TRIGGERED BY TEST
2023-10-24 | 10:33:54.671 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:132) | Unhandled exception on message from Kafka - will not retry
Message consumed from foobarTopic
The Partion:Offset is 1:2
The Key is null
2023-10-24 | 10:33:54.671 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 1:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:33:54.689 | ERROR | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.c.p.e.DefaultErrorHandler (CamelLogger.java:205) | Failed delivery for (MessageId: F48FB78BD77C762-0000000000000000 on ExchangeId: F48FB78BD77C762-0000000000000000). Exhausted after delivery attempt: 1 caught: codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST. Processed by failure processor: FatalFallbackErrorHandler[null]

Message History (source location and message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
Source                                   ID                             Processor                                          Elapsed (ms)
                                         route2/route2                  from[kafka://foobarTopic?allowManualCommit=true&au    344069196

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:33:54.689 | WARN  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:131) | Error during processing Exchange[F48FB78BD77C762-0000000000000000] from topic: foobarTopic
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:33:54.690 | WARN  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:132) | Will seek consumer to offset 1 and start polling again.
2023-10-24 | 10:33:54.697 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-0, foobarTopic-1, foobarTopic-2
2023-10-24 | 10:33:54.697 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1060) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Member consumer-test_group_id-2-ee4e9e33-2b35-435f-9f8c-7ca3ab3f8e58 sending LeaveGroup request to coordinator localhost:50591 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2023-10-24 | 10:33:54.698 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:33:54.698 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:33:54.698 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:1075) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Unsubscribed all topics or patterns and assigned partitions
2023-10-24 | 10:33:54.709 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Successfully joined group with generation Generation{generationId=2, memberId='consumer-test_group_id-3-43df7637-b2e8-42f4-af90-d24cf70078d7', protocol='range'}
2023-10-24 | 10:33:54.709 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Successfully joined group with generation Generation{generationId=2, memberId='consumer-test_group_id-1-63bb166e-e977-4462-9b1e-69c66efe7bf7', protocol='range'}
2023-10-24 | 10:33:54.709 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:33:54.713 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:659) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Finished assignment for group at generation 2: {consumer-test_group_id-1-63bb166e-e977-4462-9b1e-69c66efe7bf7=Assignment(partitions=[foobarTopic-0, foobarTopic-1]), consumer-test_group_id-3-43df7637-b2e8-42f4-af90-d24cf70078d7=Assignment(partitions=[foobarTopic-2])}
2023-10-24 | 10:33:54.714 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:33:54.725 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158034709
2023-10-24 | 10:33:54.736 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:966) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Subscribed to topic(s): foobarTopic
2023-10-24 | 10:33:54.748 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Successfully synced group in generation Generation{generationId=2, memberId='consumer-test_group_id-1-63bb166e-e977-4462-9b1e-69c66efe7bf7', protocol='range'}
2023-10-24 | 10:33:54.748 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Successfully synced group in generation Generation{generationId=2, memberId='consumer-test_group_id-3-43df7637-b2e8-42f4-af90-d24cf70078d7', protocol='range'}
2023-10-24 | 10:33:54.750 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-0, foobarTopic-1])
2023-10-24 | 10:33:54.750 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-0, foobarTopic-1
2023-10-24 | 10:33:54.750 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-2])
2023-10-24 | 10:33:54.750 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-2
2023-10-24 | 10:33:54.752 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator$OffsetFetchResponseHandler.java:1405) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Found no committed offset for partition foobarTopic-2
2023-10-24 | 10:33:54.752 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Setting offset for partition foobarTopic-0 to the committed offset FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:33:54.754 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.755 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.SubscriptionState (SubscriptionState.java:398) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Resetting offset for partition foobarTopic-2 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}.
2023-10-24 | 10:33:54.754 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Setting offset for partition foobarTopic-1 to the committed offset FetchPosition{offset=2, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:33:54.755 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.755 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.756 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Cluster ID: pImShM5YSgmKNguDY0e14g
2023-10-24 | 10:33:54.756 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$FindCoordinatorResponseHandler.java:853) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Discovered group coordinator localhost:50591 (id: 2147483647 rack: null)
2023-10-24 | 10:33:54.757 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:33:54.768 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 2:0
The Key is null
3
2023-10-24 | 10:33:54.769 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 1:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:33:54.769 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 2:0
The Key is null
3
2023-10-24 | 10:33:54.769 | ERROR | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | route2 (CamelLogger.java:163) | Having an unretryable issue due to NON RETRY ERROR TRIGGERED BY TEST
2023-10-24 | 10:33:54.770 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:132) | Unhandled exception on message from Kafka - will not retry
Message consumed from foobarTopic
The Partion:Offset is 1:2
The Key is null
2023-10-24 | 10:33:54.770 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 1:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:33:54.783 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 2:1
The Key is null
5
2023-10-24 | 10:33:54.783 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Request joining group due to: need to re-join with the given member-id
2023-10-24 | 10:33:54.784 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 2:1
The Key is null
5
2023-10-24 | 10:33:54.784 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:33:54.786 | ERROR | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.c.p.e.DefaultErrorHandler (CamelLogger.java:205) | Failed delivery for (MessageId: F48FB78BD77C762-0000000000000001 on ExchangeId: F48FB78BD77C762-0000000000000001). Exhausted after delivery attempt: 1 caught: codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST. Processed by failure processor: FatalFallbackErrorHandler[null]

Message History (source location and message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
Source                                   ID                             Processor                                          Elapsed (ms)
                                         route2/route2                  from[kafka://foobarTopic?allowManualCommit=true&au    344069296

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:33:54.787 | WARN  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:131) | Error during processing Exchange[F48FB78BD77C762-0000000000000001] from topic: foobarTopic
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:33:54.791 | WARN  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:132) | Will seek consumer to offset -1 and start polling again.
2023-10-24 | 10:33:54.792 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-0, foobarTopic-1
2023-10-24 | 10:33:54.792 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1060) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Member consumer-test_group_id-1-63bb166e-e977-4462-9b1e-69c66efe7bf7 sending LeaveGroup request to coordinator localhost:50591 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2023-10-24 | 10:33:54.794 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:33:54.794 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:33:54.795 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 2:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:33:54.795 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:1075) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Unsubscribed all topics or patterns and assigned partitions
2023-10-24 | 10:33:54.796 | ERROR | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | route2 (CamelLogger.java:163) | Having an unretryable issue due to NON RETRY ERROR TRIGGERED BY TEST
2023-10-24 | 10:33:54.796 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:132) | Unhandled exception on message from Kafka - will not retry
Message consumed from foobarTopic
The Partion:Offset is 2:2
The Key is null
2023-10-24 | 10:33:54.797 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 2:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:33:54.802 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:33:54.802 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:33:54.802 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158034802
2023-10-24 | 10:33:54.802 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:966) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Subscribed to topic(s): foobarTopic
2023-10-24 | 10:33:54.805 | ERROR | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.c.p.e.DefaultErrorHandler (CamelLogger.java:205) | Failed delivery for (MessageId: F48FB78BD77C762-0000000000000002 on ExchangeId: F48FB78BD77C762-0000000000000002). Exhausted after delivery attempt: 1 caught: codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST. Processed by failure processor: FatalFallbackErrorHandler[null]

Message History (source location and message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
Source                                   ID                             Processor                                          Elapsed (ms)
                                         route2/route2                  from[kafka://foobarTopic?allowManualCommit=true&au    344069314

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:33:54.807 | WARN  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:131) | Error during processing Exchange[F48FB78BD77C762-0000000000000002] from topic: foobarTopic
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:33:54.807 | WARN  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:132) | Will seek consumer to offset 1 and start polling again.
2023-10-24 | 10:33:54.818 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-2
2023-10-24 | 10:33:54.818 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1060) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Member consumer-test_group_id-3-43df7637-b2e8-42f4-af90-d24cf70078d7 sending LeaveGroup request to coordinator localhost:50591 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2023-10-24 | 10:33:54.818 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:33:54.819 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:33:54.821 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.821 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.821 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.821 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:1075) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Unsubscribed all topics or patterns and assigned partitions
2023-10-24 | 10:33:54.822 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Cluster ID: pImShM5YSgmKNguDY0e14g
2023-10-24 | 10:33:54.842 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Successfully joined group with generation Generation{generationId=3, memberId='consumer-test_group_id-4-8cf026f0-f8bf-45d5-9267-9c45010bdc46', protocol='range'}
2023-10-24 | 10:33:54.843 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:659) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Finished assignment for group at generation 3: {consumer-test_group_id-4-8cf026f0-f8bf-45d5-9267-9c45010bdc46=Assignment(partitions=[foobarTopic-0, foobarTopic-1, foobarTopic-2])}
2023-10-24 | 10:33:54.849 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$FindCoordinatorResponseHandler.java:853) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Discovered group coordinator localhost:50591 (id: 2147483647 rack: null)
2023-10-24 | 10:33:54.849 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:33:54.855 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:33:54.854 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:33:54.858 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158034849
2023-10-24 | 10:33:54.867 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Successfully synced group in generation Generation{generationId=3, memberId='consumer-test_group_id-4-8cf026f0-f8bf-45d5-9267-9c45010bdc46', protocol='range'}
2023-10-24 | 10:33:54.862 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:966) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Subscribed to topic(s): foobarTopic
2023-10-24 | 10:33:54.870 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-0, foobarTopic-1, foobarTopic-2])
2023-10-24 | 10:33:54.871 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-0, foobarTopic-1, foobarTopic-2
2023-10-24 | 10:33:54.876 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Setting offset for partition foobarTopic-0 to the committed offset FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:33:54.877 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Setting offset for partition foobarTopic-1 to the committed offset FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:33:54.877 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Setting offset for partition foobarTopic-2 to the committed offset FetchPosition{offset=2, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:33:54.880 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Request joining group due to: need to re-join with the given member-id
2023-10-24 | 10:33:54.881 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:33:54.892 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.892 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.893 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.893 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Cluster ID: pImShM5YSgmKNguDY0e14g
2023-10-24 | 10:33:54.895 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$FindCoordinatorResponseHandler.java:853) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Discovered group coordinator localhost:50591 (id: 2147483647 rack: null)
2023-10-24 | 10:33:54.896 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:33:54.910 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 1:3
The Key is null
7
2023-10-24 | 10:33:54.910 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Request joining group due to: need to re-join with the given member-id
2023-10-24 | 10:33:54.910 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 1:3
The Key is null
7
2023-10-24 | 10:33:54.910 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:33:54.916 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 1:4
The Key is null
8
2023-10-24 | 10:33:54.916 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 1:4
The Key is null
8
2023-10-24 | 10:33:54.921 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 1:5
The Key is null
11
2023-10-24 | 10:33:54.921 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 1:5
The Key is null
11
2023-10-24 | 10:33:54.926 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 2:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:33:54.927 | ERROR | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | route2 (CamelLogger.java:163) | Having an unretryable issue due to NON RETRY ERROR TRIGGERED BY TEST
2023-10-24 | 10:33:54.927 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:132) | Unhandled exception on message from Kafka - will not retry
Message consumed from foobarTopic
The Partion:Offset is 2:2
The Key is null
2023-10-24 | 10:33:54.927 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 2:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:33:54.933 | ERROR | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.c.p.e.DefaultErrorHandler (CamelLogger.java:205) | Failed delivery for (MessageId: F48FB78BD77C762-0000000000000003 on ExchangeId: F48FB78BD77C762-0000000000000003). Exhausted after delivery attempt: 1 caught: codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST. Processed by failure processor: FatalFallbackErrorHandler[null]

Message History (source location and message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
Source                                   ID                             Processor                                          Elapsed (ms)
                                         route2/route2                  from[kafka://foobarTopic?allowManualCommit=true&au    344069442

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:33:54.934 | WARN  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:131) | Error during processing Exchange[F48FB78BD77C762-0000000000000003] from topic: foobarTopic
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:33:54.935 | WARN  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:132) | Will seek consumer to offset 5 and start polling again.
2023-10-24 | 10:33:54.945 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-0, foobarTopic-1, foobarTopic-2
2023-10-24 | 10:33:54.945 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1060) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Member consumer-test_group_id-4-8cf026f0-f8bf-45d5-9267-9c45010bdc46 sending LeaveGroup request to coordinator localhost:50591 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2023-10-24 | 10:33:54.947 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:33:54.947 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:33:54.949 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:1075) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Unsubscribed all topics or patterns and assigned partitions
2023-10-24 | 10:33:54.954 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Successfully joined group with generation Generation{generationId=4, memberId='consumer-test_group_id-6-bddc63fa-7f0e-46cb-a5de-dc912a24a404', protocol='range'}
2023-10-24 | 10:33:54.955 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Successfully joined group with generation Generation{generationId=4, memberId='consumer-test_group_id-5-4c792a0b-54ba-4310-a57b-174d985461e0', protocol='range'}
2023-10-24 | 10:33:54.961 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:659) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Finished assignment for group at generation 4: {consumer-test_group_id-5-4c792a0b-54ba-4310-a57b-174d985461e0=Assignment(partitions=[foobarTopic-0, foobarTopic-1]), consumer-test_group_id-6-bddc63fa-7f0e-46cb-a5de-dc912a24a404=Assignment(partitions=[foobarTopic-2])}
2023-10-24 | 10:33:54.983 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:33:54.983 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Successfully synced group in generation Generation{generationId=4, memberId='consumer-test_group_id-5-4c792a0b-54ba-4310-a57b-174d985461e0', protocol='range'}
2023-10-24 | 10:33:54.984 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:33:54.987 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158034983
2023-10-24 | 10:33:54.987 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-0, foobarTopic-1])
2023-10-24 | 10:33:54.987 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Successfully synced group in generation Generation{generationId=4, memberId='consumer-test_group_id-6-bddc63fa-7f0e-46cb-a5de-dc912a24a404', protocol='range'}
2023-10-24 | 10:33:54.988 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-2])
2023-10-24 | 10:33:54.988 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-2
2023-10-24 | 10:33:54.988 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-0, foobarTopic-1
2023-10-24 | 10:33:54.988 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:966) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Subscribed to topic(s): foobarTopic
2023-10-24 | 10:33:54.993 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Setting offset for partition foobarTopic-0 to the committed offset FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:33:54.993 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Setting offset for partition foobarTopic-2 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:33:54.993 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Setting offset for partition foobarTopic-1 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:33:54.998 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.998 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.998 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:54.999 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Cluster ID: pImShM5YSgmKNguDY0e14g
2023-10-24 | 10:33:54.999 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$FindCoordinatorResponseHandler.java:853) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Discovered group coordinator localhost:50591 (id: 2147483647 rack: null)
2023-10-24 | 10:33:55.004 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:33:55.013 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Request joining group due to: need to re-join with the given member-id
2023-10-24 | 10:33:55.014 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:33:55.020 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.consumer.internals.Fetcher (Fetcher.java:1413) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Fetch position FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}} is out of range for partition foobarTopic-2, resetting offset
2023-10-24 | 10:33:55.022 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.SubscriptionState (SubscriptionState.java:398) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Resetting offset for partition foobarTopic-2 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}.
2023-10-24 | 10:33:55.032 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 2:0
The Key is null
3
2023-10-24 | 10:33:55.032 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 2:0
The Key is null
3
2023-10-24 | 10:33:55.037 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 2:1
The Key is null
5
2023-10-24 | 10:33:55.041 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 2:1
The Key is null
5
2023-10-24 | 10:33:55.050 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 2:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:33:55.053 | ERROR | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | route2 (CamelLogger.java:163) | Having an unretryable issue due to NON RETRY ERROR TRIGGERED BY TEST
2023-10-24 | 10:33:55.053 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:132) | Unhandled exception on message from Kafka - will not retry
Message consumed from foobarTopic
The Partion:Offset is 2:2
The Key is null
2023-10-24 | 10:33:55.054 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 2:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:33:55.060 | ERROR | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.c.p.e.DefaultErrorHandler (CamelLogger.java:205) | Failed delivery for (MessageId: F48FB78BD77C762-0000000000000004 on ExchangeId: F48FB78BD77C762-0000000000000004). Exhausted after delivery attempt: 1 caught: codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST. Processed by failure processor: FatalFallbackErrorHandler[null]

Message History (source location and message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
Source                                   ID                             Processor                                          Elapsed (ms)
                                         route2/route2                  from[kafka://foobarTopic?allowManualCommit=true&au    344069570

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:33:55.064 | WARN  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:131) | Error during processing Exchange[F48FB78BD77C762-0000000000000004] from topic: foobarTopic
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:33:55.064 | WARN  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:132) | Will seek consumer to offset 1 and start polling again.
2023-10-24 | 10:33:55.066 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-2
2023-10-24 | 10:33:55.067 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1060) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Member consumer-test_group_id-6-bddc63fa-7f0e-46cb-a5de-dc912a24a404 sending LeaveGroup request to coordinator localhost:50591 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2023-10-24 | 10:33:55.067 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:33:55.067 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:33:55.067 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:1075) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Unsubscribed all topics or patterns and assigned partitions
2023-10-24 | 10:33:55.071 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:33:55.071 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:33:55.071 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158035071
2023-10-24 | 10:33:55.071 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:966) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Subscribed to topic(s): foobarTopic
2023-10-24 | 10:33:55.079 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:55.080 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:55.080 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:55.081 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Cluster ID: pImShM5YSgmKNguDY0e14g
2023-10-24 | 10:33:55.081 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$FindCoordinatorResponseHandler.java:853) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Discovered group coordinator localhost:50591 (id: 2147483647 rack: null)
2023-10-24 | 10:33:55.081 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:33:55.093 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Request joining group due to: need to re-join with the given member-id
2023-10-24 | 10:33:55.095 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:33:57.966 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Request joining group due to: group is already rebalancing
2023-10-24 | 10:33:57.967 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-0, foobarTopic-1
2023-10-24 | 10:33:57.967 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:33:57.984 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Successfully joined group with generation Generation{generationId=5, memberId='consumer-test_group_id-5-4c792a0b-54ba-4310-a57b-174d985461e0', protocol='range'}
2023-10-24 | 10:33:57.984 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Successfully joined group with generation Generation{generationId=5, memberId='consumer-test_group_id-7-823132de-0f48-4cac-b6f1-991f53af63ca', protocol='range'}
2023-10-24 | 10:33:57.984 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Successfully joined group with generation Generation{generationId=5, memberId='consumer-test_group_id-8-9bf6cf9f-9c19-440d-9333-f8c101d4f5ba', protocol='range'}
2023-10-24 | 10:33:57.999 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:659) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Finished assignment for group at generation 5: {consumer-test_group_id-5-4c792a0b-54ba-4310-a57b-174d985461e0=Assignment(partitions=[foobarTopic-0]), consumer-test_group_id-8-9bf6cf9f-9c19-440d-9333-f8c101d4f5ba=Assignment(partitions=[foobarTopic-2]), consumer-test_group_id-7-823132de-0f48-4cac-b6f1-991f53af63ca=Assignment(partitions=[foobarTopic-1])}
2023-10-24 | 10:33:58.014 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Successfully synced group in generation Generation{generationId=5, memberId='consumer-test_group_id-5-4c792a0b-54ba-4310-a57b-174d985461e0', protocol='range'}
2023-10-24 | 10:33:58.014 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Successfully synced group in generation Generation{generationId=5, memberId='consumer-test_group_id-8-9bf6cf9f-9c19-440d-9333-f8c101d4f5ba', protocol='range'}
2023-10-24 | 10:33:58.014 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Successfully synced group in generation Generation{generationId=5, memberId='consumer-test_group_id-7-823132de-0f48-4cac-b6f1-991f53af63ca', protocol='range'}
2023-10-24 | 10:33:58.016 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-1])
2023-10-24 | 10:33:58.016 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-2])
2023-10-24 | 10:33:58.016 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-0])
2023-10-24 | 10:33:58.016 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-1
2023-10-24 | 10:33:58.016 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-2
2023-10-24 | 10:33:58.016 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-0
2023-10-24 | 10:33:58.018 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Setting offset for partition foobarTopic-1 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:33:58.018 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Setting offset for partition foobarTopic-2 to the committed offset FetchPosition{offset=2, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:33:58.018 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Setting offset for partition foobarTopic-0 to the committed offset FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:33:58.053 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 2:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:33:58.054 | ERROR | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | route2 (CamelLogger.java:163) | Having an unretryable issue due to NON RETRY ERROR TRIGGERED BY TEST
2023-10-24 | 10:33:58.055 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:132) | Unhandled exception on message from Kafka - will not retry
Message consumed from foobarTopic
The Partion:Offset is 2:2
The Key is null
2023-10-24 | 10:33:58.055 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 2:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:33:58.061 | ERROR | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.c.p.e.DefaultErrorHandler (CamelLogger.java:205) | Failed delivery for (MessageId: F48FB78BD77C762-0000000000000005 on ExchangeId: F48FB78BD77C762-0000000000000005). Exhausted after delivery attempt: 1 caught: codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST. Processed by failure processor: FatalFallbackErrorHandler[null]

Message History (source location and message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
Source                                   ID                             Processor                                          Elapsed (ms)
                                         route2/route2                  from[kafka://foobarTopic?allowManualCommit=true&au    344072570

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:33:58.062 | WARN  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:131) | Error during processing Exchange[F48FB78BD77C762-0000000000000005] from topic: foobarTopic
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:33:58.062 | WARN  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:132) | Will seek consumer to offset -1 and start polling again.
2023-10-24 | 10:33:58.063 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-2
2023-10-24 | 10:33:58.063 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1060) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Member consumer-test_group_id-8-9bf6cf9f-9c19-440d-9333-f8c101d4f5ba sending LeaveGroup request to coordinator localhost:50591 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2023-10-24 | 10:33:58.064 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:33:58.064 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:33:58.065 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:1075) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Unsubscribed all topics or patterns and assigned partitions
2023-10-24 | 10:33:58.079 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:33:58.079 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:33:58.081 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158038078
2023-10-24 | 10:33:58.082 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:966) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Subscribed to topic(s): foobarTopic
2023-10-24 | 10:33:58.108 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:58.111 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:58.111 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to lPi2luKESZGI0YdKTtmt9w
2023-10-24 | 10:33:58.113 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Cluster ID: pImShM5YSgmKNguDY0e14g
2023-10-24 | 10:33:58.117 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$FindCoordinatorResponseHandler.java:853) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Discovered group coordinator localhost:50591 (id: 2147483647 rack: null)
2023-10-24 | 10:33:58.119 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:33:58.131 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Request joining group due to: need to re-join with the given member-id
2023-10-24 | 10:33:58.132 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:00.995 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Request joining group due to: group is already rebalancing
2023-10-24 | 10:34:00.995 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Request joining group due to: group is already rebalancing
2023-10-24 | 10:34:01.015 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-1
2023-10-24 | 10:34:01.015 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-0
2023-10-24 | 10:34:01.016 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:01.016 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:01.033 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Successfully joined group with generation Generation{generationId=6, memberId='consumer-test_group_id-9-f9eff172-df40-40b1-a4c0-448e8f0ba97b', protocol='range'}
2023-10-24 | 10:34:01.051 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Successfully joined group with generation Generation{generationId=6, memberId='consumer-test_group_id-7-823132de-0f48-4cac-b6f1-991f53af63ca', protocol='range'}
2023-10-24 | 10:34:01.052 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Successfully joined group with generation Generation{generationId=6, memberId='consumer-test_group_id-5-4c792a0b-54ba-4310-a57b-174d985461e0', protocol='range'}
2023-10-24 | 10:34:01.056 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:659) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Finished assignment for group at generation 6: {consumer-test_group_id-5-4c792a0b-54ba-4310-a57b-174d985461e0=Assignment(partitions=[foobarTopic-0]), consumer-test_group_id-9-f9eff172-df40-40b1-a4c0-448e8f0ba97b=Assignment(partitions=[foobarTopic-2]), consumer-test_group_id-7-823132de-0f48-4cac-b6f1-991f53af63ca=Assignment(partitions=[foobarTopic-1])}
2023-10-24 | 10:34:01.065 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Successfully synced group in generation Generation{generationId=6, memberId='consumer-test_group_id-5-4c792a0b-54ba-4310-a57b-174d985461e0', protocol='range'}
2023-10-24 | 10:34:01.065 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Successfully synced group in generation Generation{generationId=6, memberId='consumer-test_group_id-9-f9eff172-df40-40b1-a4c0-448e8f0ba97b', protocol='range'}
2023-10-24 | 10:34:01.066 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Successfully synced group in generation Generation{generationId=6, memberId='consumer-test_group_id-7-823132de-0f48-4cac-b6f1-991f53af63ca', protocol='range'}
2023-10-24 | 10:34:01.066 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-2])
2023-10-24 | 10:34:01.066 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-0])
2023-10-24 | 10:34:01.066 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-1])
2023-10-24 | 10:34:01.066 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-2
2023-10-24 | 10:34:01.066 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-0
2023-10-24 | 10:34:01.066 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-1
2023-10-24 | 10:34:01.073 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Setting offset for partition foobarTopic-2 to the committed offset FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:34:01.073 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Setting offset for partition foobarTopic-0 to the committed offset FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:34:01.073 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Setting offset for partition foobarTopic-1 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:34:01.088 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 2:3
The Key is null
9
2023-10-24 | 10:34:01.088 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 2:3
The Key is null
9
2023-10-24 | 10:34:04.443 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: NORETRY-ERROR 6 times
2023-10-24 | 10:34:04.443 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 3 2 times
2023-10-24 | 10:34:04.444 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 5 2 times
2023-10-24 | 10:34:04.444 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 11 1 times
2023-10-24 | 10:34:04.444 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 1 1 times
2023-10-24 | 10:34:04.444 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 2 1 times
2023-10-24 | 10:34:04.444 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 4 1 times
2023-10-24 | 10:34:04.444 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 6 1 times
2023-10-24 | 10:34:04.444 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 7 1 times
2023-10-24 | 10:34:04.444 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 8 1 times
2023-10-24 | 10:34:04.444 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 9 1 times
2023-10-24 | 10:34:04.444 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 10 1 times
2023-10-24 | 10:34:04.546 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (StopWatchTestExecutionListener.java:64) | ********************************************************************************
2023-10-24 | 10:34:04.547 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (StopWatchTestExecutionListener.java:65) | Testing done: offsetRestIncorrectlyOnRejoin (codesmell.test.CamelKafkaOffsetTest)
2023-10-24 | 10:34:04.547 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (StopWatchTestExecutionListener.java:66) | Took: 12s53ms (12053 millis)
2023-10-24 | 10:34:04.547 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (StopWatchTestExecutionListener.java:67) | ********************************************************************************
2023-10-24 | 10:34:05.020 | INFO  | [Camel (camel-1) thread #14 - ShutdownTask] | o.a.kafka.common.metrics.Metrics (Metrics.java:659) | Metrics scheduler closed
2023-10-24 | 10:34:05.020 | INFO  | [Camel (camel-1) thread #14 - ShutdownTask] | o.a.kafka.common.metrics.Metrics (Metrics.java:663) | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2023-10-24 | 10:34:05.024 | INFO  | [Camel (camel-1) thread #14 - ShutdownTask] | o.a.kafka.common.metrics.Metrics (Metrics.java:669) | Metrics reporters closed
2023-10-24 | 10:34:05.028 | INFO  | [Camel (camel-1) thread #14 - ShutdownTask] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser.java:83) | App info kafka.producer for producer-1 unregistered
2023-10-24 | 10:34:06.093 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-2
2023-10-24 | 10:34:06.094 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1060) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Member consumer-test_group_id-9-f9eff172-df40-40b1-a4c0-448e8f0ba97b sending LeaveGroup request to coordinator localhost:50591 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2023-10-24 | 10:34:06.096 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:06.096 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:06.096 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:1075) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Unsubscribed all topics or patterns and assigned partitions
2023-10-24 | 10:34:06.102 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:06.102 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-9, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:06.106 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.metrics.Metrics (Metrics.java:659) | Metrics scheduler closed
2023-10-24 | 10:34:06.107 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.metrics.Metrics (Metrics.java:663) | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2023-10-24 | 10:34:06.107 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.metrics.Metrics (Metrics.java:669) | Metrics reporters closed
2023-10-24 | 10:34:06.109 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser.java:83) | App info kafka.consumer for consumer-test_group_id-9 unregistered
2023-10-24 | 10:34:07.082 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Request joining group due to: group is already rebalancing
2023-10-24 | 10:34:07.082 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Request joining group due to: group is already rebalancing
2023-10-24 | 10:34:07.087 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-0
2023-10-24 | 10:34:07.087 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-1
2023-10-24 | 10:34:07.088 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:07.088 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:07.108 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Successfully joined group with generation Generation{generationId=7, memberId='consumer-test_group_id-5-4c792a0b-54ba-4310-a57b-174d985461e0', protocol='range'}
2023-10-24 | 10:34:07.111 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:659) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Finished assignment for group at generation 7: {consumer-test_group_id-5-4c792a0b-54ba-4310-a57b-174d985461e0=Assignment(partitions=[foobarTopic-0, foobarTopic-1]), consumer-test_group_id-7-823132de-0f48-4cac-b6f1-991f53af63ca=Assignment(partitions=[foobarTopic-2])}
2023-10-24 | 10:34:07.114 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Successfully joined group with generation Generation{generationId=7, memberId='consumer-test_group_id-7-823132de-0f48-4cac-b6f1-991f53af63ca', protocol='range'}
2023-10-24 | 10:34:07.135 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Successfully synced group in generation Generation{generationId=7, memberId='consumer-test_group_id-5-4c792a0b-54ba-4310-a57b-174d985461e0', protocol='range'}
2023-10-24 | 10:34:07.135 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Successfully synced group in generation Generation{generationId=7, memberId='consumer-test_group_id-7-823132de-0f48-4cac-b6f1-991f53af63ca', protocol='range'}
2023-10-24 | 10:34:07.136 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-0, foobarTopic-1])
2023-10-24 | 10:34:07.136 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-2])
2023-10-24 | 10:34:07.136 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-0, foobarTopic-1
2023-10-24 | 10:34:07.137 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-2
2023-10-24 | 10:34:07.142 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Setting offset for partition foobarTopic-0 to the committed offset FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:34:07.142 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Setting offset for partition foobarTopic-2 to the committed offset FetchPosition{offset=4, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:34:07.143 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Setting offset for partition foobarTopic-1 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50591 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:34:09.815 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-0, foobarTopic-1
2023-10-24 | 10:34:09.815 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1060) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Member consumer-test_group_id-5-4c792a0b-54ba-4310-a57b-174d985461e0 sending LeaveGroup request to coordinator localhost:50591 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2023-10-24 | 10:34:09.816 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:09.817 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:09.817 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:1075) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Unsubscribed all topics or patterns and assigned partitions
2023-10-24 | 10:34:09.817 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:09.817 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:09.818 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.metrics.Metrics (Metrics.java:659) | Metrics scheduler closed
2023-10-24 | 10:34:09.819 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.metrics.Metrics (Metrics.java:663) | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2023-10-24 | 10:34:09.819 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.metrics.Metrics (Metrics.java:669) | Metrics reporters closed
2023-10-24 | 10:34:09.821 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser.java:83) | App info kafka.consumer for consumer-test_group_id-5 unregistered
2023-10-24 | 10:34:09.995 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-2
2023-10-24 | 10:34:09.998 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1060) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Member consumer-test_group_id-7-823132de-0f48-4cac-b6f1-991f53af63ca sending LeaveGroup request to coordinator localhost:50591 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2023-10-24 | 10:34:09.998 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:09.998 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:09.999 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:1075) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Unsubscribed all topics or patterns and assigned partitions
2023-10-24 | 10:34:10.007 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:10.009 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:10.022 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.metrics.Metrics (Metrics.java:659) | Metrics scheduler closed
2023-10-24 | 10:34:10.022 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.metrics.Metrics (Metrics.java:663) | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2023-10-24 | 10:34:10.023 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.metrics.Metrics (Metrics.java:669) | Metrics reporters closed
2023-10-24 | 10:34:10.027 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser.java:83) | App info kafka.consumer for consumer-test_group_id-7 unregistered
2023-10-24 | 10:34:10.093 | INFO  | [SpringContextShutdownHook] | k.c.ZkNodeChangeNotificationListener$ChangeEventProcessThread (Logging.java:66) | [/config/changes-event-process-thread]: Shutting down
2023-10-24 | 10:34:10.095 | INFO  | [SpringContextShutdownHook] | k.c.ZkNodeChangeNotificationListener$ChangeEventProcessThread (Logging.java:66) | [/config/changes-event-process-thread]: Shutdown completed
2023-10-24 | 10:34:10.095 | INFO  | [/config/changes-event-process-thread] | k.c.ZkNodeChangeNotificationListener$ChangeEventProcessThread (Logging.java:66) | [/config/changes-event-process-thread]: Stopped
2023-10-24 | 10:34:10.973 | INFO  | [main] | o.s.t.c.s.DefaultTestContextBootstrapper (AbstractTestContextBootstrapper.java:305) | Neither @ContextConfiguration nor @ContextHierarchy found for test class [codesmell.test.CamelKafkaOffsetTest], using DelegatingSmartContextLoader
2023-10-24 | 10:34:10.985 | INFO  | [main] | o.s.t.c.s.AbstractContextLoader (AbstractContextLoader.java:264) | Could not detect default resource locations for test class [codesmell.test.CamelKafkaOffsetTest]: no resource found for suffixes {-context.xml}.
2023-10-24 | 10:34:10.986 | INFO  | [main] | o.s.t.c.s.AnnotationConfigContextLoaderUtils (AnnotationConfigContextLoaderUtils.java:83) | Could not detect default configuration classes for test class [codesmell.test.CamelKafkaOffsetTest]: CamelKafkaOffsetTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2023-10-24 | 10:34:11.108 | INFO  | [main] | o.s.t.c.s.DefaultTestContextBootstrapper (AbstractTestContextBootstrapper.java:245) | Loaded default TestExecutionListener class names from location [META-INF/spring.factories]: [org.springframework.test.context.web.ServletTestExecutionListener, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener, org.springframework.test.context.event.ApplicationEventsTestExecutionListener, org.springframework.test.context.support.DependencyInjectionTestExecutionListener, org.springframework.test.context.support.DirtiesContextTestExecutionListener, org.springframework.test.context.transaction.TransactionalTestExecutionListener, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener, org.springframework.test.context.event.EventPublishingTestExecutionListener, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener, org.springframework.boot.test.autoconfigure.webservices.client.MockWebServiceServerTestExecutionListener]
2023-10-24 | 10:34:11.128 | INFO  | [main] | o.s.t.c.s.DefaultTestContextBootstrapper (AbstractTestContextBootstrapper.java:174) | Using TestExecutionListeners: [org.apache.camel.test.spring.junit5.CamelSpringTestContextLoaderTestExecutionListener@1a7288a3, org.apache.camel.test.spring.junit5.CamelSpringBootExecutionListener@2974f221, org.apache.camel.test.spring.junit5.StopWatchTestExecutionListener@58fe0499, org.springframework.test.context.support.DirtiesContextBeforeModesTestExecutionListener@686449f9, org.springframework.test.context.event.ApplicationEventsTestExecutionListener@665df3c6, org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener@68b6f0d6, org.springframework.test.context.support.DependencyInjectionTestExecutionListener@4044fb95, org.springframework.test.context.support.DirtiesContextTestExecutionListener@aa549e5, org.springframework.test.context.transaction.TransactionalTestExecutionListener@36f48b4, org.springframework.test.context.jdbc.SqlScriptsTestExecutionListener@5c00384f, org.springframework.test.context.event.EventPublishingTestExecutionListener@3b7ff809, org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener@1bb564e2, org.springframework.boot.test.autoconfigure.restdocs.RestDocsTestExecutionListener@62e6b5c8, org.springframework.boot.test.autoconfigure.web.client.MockRestServiceServerResetTestExecutionListener@3f792b9b, org.springframework.boot.test.autoconfigure.web.servlet.MockMvcPrintOnlyOnFailureTestExecutionListener@7b8233cd, org.springframework.boot.test.autoconfigure.web.servlet.WebDriverTestExecutionListener@4b20ca2b, org.springframework.boot.test.autoconfigure.webservices.client.MockWebServiceServerTestExecutionListener@1cbf6e72]
2023-10-24 | 10:34:11.688 | INFO  | [main] | k.utils.Log4jControllerRegistration$ (Log4jControllerRegistration$.java:31) | Registered kafka:type=kafka.Log4jController MBean
2023-10-24 | 10:34:11.756 | WARN  | [main] | o.a.z.server.ServerCnxnFactory (ServerCnxnFactory.java:309) | maxCnxns is not configured, using default value 0.
2023-10-24 | 10:34:12.811 | WARN  | [main] | k.server.BrokerMetadataCheckpoint (Logging.java:70) | No meta.properties file under dir /var/folders/82/qc43__sx1qg1wqrtl2csq6r80000gq/T/spring.kafka.c40a7f33-a36e-489a-8179-edc82ddaf12017161733844979099878/meta.properties
2023-10-24 | 10:34:13.335 | INFO  | [SpringContextShutdownHook] | o.a.kafka.common.metrics.Metrics (Metrics.java:659) | Metrics scheduler closed
2023-10-24 | 10:34:13.336 | INFO  | [SpringContextShutdownHook] | o.a.kafka.common.metrics.Metrics (Metrics.java:663) | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2023-10-24 | 10:34:13.336 | INFO  | [SpringContextShutdownHook] | o.a.kafka.common.metrics.Metrics (Metrics.java:669) | Metrics reporters closed
2023-10-24 | 10:34:13.341 | INFO  | [SpringContextShutdownHook] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser.java:83) | App info kafka.server for 0 unregistered
2023-10-24 | 10:34:13.903 | INFO  | [/config/changes-event-process-thread] | k.c.ZkNodeChangeNotificationListener$ChangeEventProcessThread (Logging.java:66) | [/config/changes-event-process-thread]: Starting
2023-10-24 | 10:34:13.963 | INFO  | [main] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:34:13.964 | INFO  | [main] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:34:13.965 | INFO  | [main] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158053955
2023-10-24 | 10:34:14.044 | INFO  | [main] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:34:14.045 | INFO  | [main] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:34:14.045 | INFO  | [main] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158054044
2023-10-24 | 10:34:14.070 | INFO  | [kafka-admin-client-thread | adminclient-1] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser.java:83) | App info kafka.admin.client for adminclient-1 unregistered
2023-10-24 | 10:34:14.083 | INFO  | [kafka-admin-client-thread | adminclient-1] | o.a.k.c.a.i.AdminMetadataManager (AdminMetadataManager.java:235) | [AdminClient clientId=adminclient-1] Metadata update failed
org.apache.kafka.common.errors.TimeoutException: Timed out waiting to send the call. Call: fetchMetadata
2023-10-24 | 10:34:14.089 | INFO  | [kafka-admin-client-thread | adminclient-1] | o.a.k.clients.admin.KafkaAdminClient (KafkaAdminClient$AdminClientRunnable.java:1346) | [AdminClient clientId=adminclient-1] Timed out 1 remaining operation(s) during close.
2023-10-24 | 10:34:14.099 | INFO  | [kafka-admin-client-thread | adminclient-1] | o.a.kafka.common.metrics.Metrics (Metrics.java:659) | Metrics scheduler closed
2023-10-24 | 10:34:14.100 | INFO  | [kafka-admin-client-thread | adminclient-1] | o.a.kafka.common.metrics.Metrics (Metrics.java:663) | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2023-10-24 | 10:34:14.109 | INFO  | [kafka-admin-client-thread | adminclient-1] | o.a.kafka.common.metrics.Metrics (Metrics.java:669) | Metrics reporters closed
2023-10-24 | 10:34:18.117 | INFO  | [main] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:34:18.120 | INFO  | [main] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:34:18.120 | INFO  | [main] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158058115
2023-10-24 | 10:34:18.187 | INFO  | [kafka-producer-network-thread | producer-1] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Producer clientId=producer-1] Cluster ID: DiKCfE60Ql66Mrsd8YBHIA
2023-10-24 | 10:34:18.214 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 1
2023-10-24 | 10:34:18.280 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:34:18.286 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:34:18.287 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158058280
2023-10-24 | 10:34:18.288 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:34:18.288 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:34:18.288 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158058280
2023-10-24 | 10:34:18.291 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:34:18.295 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:34:18.295 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158058280
2023-10-24 | 10:34:18.305 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:966) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Subscribed to topic(s): foobarTopic
2023-10-24 | 10:34:18.305 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:966) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Subscribed to topic(s): foobarTopic
2023-10-24 | 10:34:18.305 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:966) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Subscribed to topic(s): foobarTopic
2023-10-24 | 10:34:18.359 | WARN  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Error while fetching metadata with correlation id 2 : {foobarTopic=UNKNOWN_TOPIC_OR_PARTITION}
2023-10-24 | 10:34:18.358 | WARN  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Error while fetching metadata with correlation id 2 : {foobarTopic=UNKNOWN_TOPIC_OR_PARTITION}
2023-10-24 | 10:34:18.358 | WARN  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Error while fetching metadata with correlation id 2 : {foobarTopic=UNKNOWN_TOPIC_OR_PARTITION}
2023-10-24 | 10:34:18.363 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Cluster ID: DiKCfE60Ql66Mrsd8YBHIA
2023-10-24 | 10:34:18.363 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Cluster ID: DiKCfE60Ql66Mrsd8YBHIA
2023-10-24 | 10:34:18.363 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Cluster ID: DiKCfE60Ql66Mrsd8YBHIA
2023-10-24 | 10:34:18.375 | WARN  | [kafka-producer-network-thread | producer-1] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Producer clientId=producer-1] Error while fetching metadata with correlation id 3 : {foobarTopic=LEADER_NOT_AVAILABLE}
2023-10-24 | 10:34:18.495 | WARN  | [kafka-producer-network-thread | producer-1] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Producer clientId=producer-1] Error while fetching metadata with correlation id 4 : {foobarTopic=LEADER_NOT_AVAILABLE}
2023-10-24 | 10:34:18.503 | WARN  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Error while fetching metadata with correlation id 4 : {foobarTopic=UNKNOWN_TOPIC_OR_PARTITION}
2023-10-24 | 10:34:18.503 | WARN  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Error while fetching metadata with correlation id 4 : {foobarTopic=UNKNOWN_TOPIC_OR_PARTITION}
2023-10-24 | 10:34:18.516 | WARN  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Error while fetching metadata with correlation id 4 : {foobarTopic=LEADER_NOT_AVAILABLE}
2023-10-24 | 10:34:18.609 | WARN  | [kafka-producer-network-thread | producer-1] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Producer clientId=producer-1] Error while fetching metadata with correlation id 5 : {foobarTopic=LEADER_NOT_AVAILABLE}
2023-10-24 | 10:34:18.609 | WARN  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Error while fetching metadata with correlation id 6 : {foobarTopic=UNKNOWN_TOPIC_OR_PARTITION}
2023-10-24 | 10:34:18.613 | WARN  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Error while fetching metadata with correlation id 6 : {foobarTopic=LEADER_NOT_AVAILABLE}
2023-10-24 | 10:34:18.620 | WARN  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Error while fetching metadata with correlation id 6 : {foobarTopic=LEADER_NOT_AVAILABLE}
2023-10-24 | 10:34:18.710 | WARN  | [kafka-producer-network-thread | producer-1] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Producer clientId=producer-1] Error while fetching metadata with correlation id 6 : {foobarTopic=LEADER_NOT_AVAILABLE}
2023-10-24 | 10:34:18.713 | WARN  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Error while fetching metadata with correlation id 8 : {foobarTopic=LEADER_NOT_AVAILABLE}
2023-10-24 | 10:34:18.717 | WARN  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Error while fetching metadata with correlation id 8 : {foobarTopic=LEADER_NOT_AVAILABLE}
2023-10-24 | 10:34:18.724 | WARN  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.apache.kafka.clients.NetworkClient (NetworkClient$DefaultMetadataUpdater.java:1103) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Error while fetching metadata with correlation id 8 : {foobarTopic=LEADER_NOT_AVAILABLE}
2023-10-24 | 10:34:18.818 | INFO  | [kafka-producer-network-thread | producer-1] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Producer clientId=producer-1] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:18.818 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:18.819 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:18.827 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:18.837 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:18.837 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:18.837 | INFO  | [kafka-producer-network-thread | producer-1] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Producer clientId=producer-1] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:18.840 | INFO  | [kafka-producer-network-thread | producer-1] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Producer clientId=producer-1] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:18.840 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:18.837 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:18.840 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:18.840 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:18.912 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 2
2023-10-24 | 10:34:18.942 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 3
2023-10-24 | 10:34:18.953 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 4
2023-10-24 | 10:34:18.991 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 5
2023-10-24 | 10:34:18.996 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> NORETRY-ERROR
2023-10-24 | 10:34:19.034 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 6
2023-10-24 | 10:34:19.042 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 7
2023-10-24 | 10:34:19.049 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> NORETRY-ERROR
2023-10-24 | 10:34:19.049 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$FindCoordinatorResponseHandler.java:853) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Discovered group coordinator localhost:50643 (id: 2147483647 rack: null)
2023-10-24 | 10:34:19.053 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:19.058 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 8
2023-10-24 | 10:34:19.061 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 9
2023-10-24 | 10:34:19.063 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 10
2023-10-24 | 10:34:19.070 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:105) | publishing payload >>> 11
2023-10-24 | 10:34:19.092 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Request joining group due to: need to re-join with the given member-id
2023-10-24 | 10:34:19.092 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:19.107 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Successfully joined group with generation Generation{generationId=1, memberId='consumer-test_group_id-3-5ecc5c1e-a143-44f3-add6-0a12d65c0e77', protocol='range'}
2023-10-24 | 10:34:19.109 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:659) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Finished assignment for group at generation 1: {consumer-test_group_id-3-5ecc5c1e-a143-44f3-add6-0a12d65c0e77=Assignment(partitions=[foobarTopic-0, foobarTopic-1, foobarTopic-2])}
2023-10-24 | 10:34:19.140 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$FindCoordinatorResponseHandler.java:853) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Discovered group coordinator localhost:50643 (id: 2147483647 rack: null)
2023-10-24 | 10:34:19.140 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$FindCoordinatorResponseHandler.java:853) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Discovered group coordinator localhost:50643 (id: 2147483647 rack: null)
2023-10-24 | 10:34:19.140 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Successfully synced group in generation Generation{generationId=1, memberId='consumer-test_group_id-3-5ecc5c1e-a143-44f3-add6-0a12d65c0e77', protocol='range'}
2023-10-24 | 10:34:19.142 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-0, foobarTopic-1, foobarTopic-2])
2023-10-24 | 10:34:19.142 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:19.144 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:19.152 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-0, foobarTopic-1, foobarTopic-2
2023-10-24 | 10:34:19.183 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator$OffsetFetchResponseHandler.java:1405) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Found no committed offset for partition foobarTopic-0
2023-10-24 | 10:34:19.184 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator$OffsetFetchResponseHandler.java:1405) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Found no committed offset for partition foobarTopic-1
2023-10-24 | 10:34:19.185 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator$OffsetFetchResponseHandler.java:1405) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Found no committed offset for partition foobarTopic-2
2023-10-24 | 10:34:19.190 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Request joining group due to: need to re-join with the given member-id
2023-10-24 | 10:34:19.190 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Request joining group due to: need to re-join with the given member-id
2023-10-24 | 10:34:19.192 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:19.192 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:19.225 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.SubscriptionState (SubscriptionState.java:398) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Resetting offset for partition foobarTopic-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}.
2023-10-24 | 10:34:19.227 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.SubscriptionState (SubscriptionState.java:398) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Resetting offset for partition foobarTopic-1 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}.
2023-10-24 | 10:34:19.227 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.SubscriptionState (SubscriptionState.java:398) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Resetting offset for partition foobarTopic-2 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}.
2023-10-24 | 10:34:19.281 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 0:0
The Key is null
2
2023-10-24 | 10:34:19.286 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 0:0
The Key is null
2
2023-10-24 | 10:34:19.302 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 0:1
The Key is null
4
2023-10-24 | 10:34:19.302 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 0:1
The Key is null
4
2023-10-24 | 10:34:19.306 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 0:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:34:19.324 | ERROR | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | route2 (CamelLogger.java:163) | Having an unretryable issue due to NON RETRY ERROR TRIGGERED BY TEST
2023-10-24 | 10:34:19.326 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:132) | Unhandled exception on message from Kafka - will not retry
Message consumed from foobarTopic
The Partion:Offset is 0:2
The Key is null
2023-10-24 | 10:34:19.326 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 0:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:34:19.346 | ERROR | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.c.p.e.DefaultErrorHandler (CamelLogger.java:205) | Failed delivery for (MessageId: E1DCA3D2ADF9E86-0000000000000000 on ExchangeId: E1DCA3D2ADF9E86-0000000000000000). Exhausted after delivery attempt: 1 caught: codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST. Processed by failure processor: FatalFallbackErrorHandler[null]

Message History (source location and message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
Source                                   ID                             Processor                                          Elapsed (ms)
                                         route2/route2                  from[kafka://foobarTopic?allowManualCommit=true&au    344093854

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:34:19.347 | WARN  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:131) | Error during processing Exchange[E1DCA3D2ADF9E86-0000000000000000] from topic: foobarTopic
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:34:19.348 | WARN  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:132) | Will seek consumer to offset 1 and start polling again.
2023-10-24 | 10:34:19.353 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-0, foobarTopic-1, foobarTopic-2
2023-10-24 | 10:34:19.354 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1060) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Member consumer-test_group_id-3-5ecc5c1e-a143-44f3-add6-0a12d65c0e77 sending LeaveGroup request to coordinator localhost:50643 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2023-10-24 | 10:34:19.354 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:19.354 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:19.355 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:1075) | [Consumer clientId=consumer-test_group_id-3, groupId=test_group_id] Unsubscribed all topics or patterns and assigned partitions
2023-10-24 | 10:34:19.368 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Successfully joined group with generation Generation{generationId=2, memberId='consumer-test_group_id-2-c356c099-325d-430b-a023-d00551776ddd', protocol='range'}
2023-10-24 | 10:34:19.368 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Successfully joined group with generation Generation{generationId=2, memberId='consumer-test_group_id-1-99e5ea8f-8a53-4e16-86ab-8b53b886a991', protocol='range'}
2023-10-24 | 10:34:19.364 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:34:19.370 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:34:19.370 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158059364
2023-10-24 | 10:34:19.372 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:659) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Finished assignment for group at generation 2: {consumer-test_group_id-1-99e5ea8f-8a53-4e16-86ab-8b53b886a991=Assignment(partitions=[foobarTopic-0, foobarTopic-1]), consumer-test_group_id-2-c356c099-325d-430b-a023-d00551776ddd=Assignment(partitions=[foobarTopic-2])}
2023-10-24 | 10:34:19.379 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:966) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Subscribed to topic(s): foobarTopic
2023-10-24 | 10:34:19.400 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Successfully synced group in generation Generation{generationId=2, memberId='consumer-test_group_id-1-99e5ea8f-8a53-4e16-86ab-8b53b886a991', protocol='range'}
2023-10-24 | 10:34:19.400 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Successfully synced group in generation Generation{generationId=2, memberId='consumer-test_group_id-2-c356c099-325d-430b-a023-d00551776ddd', protocol='range'}
2023-10-24 | 10:34:19.403 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-0, foobarTopic-1])
2023-10-24 | 10:34:19.407 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-2])
2023-10-24 | 10:34:19.412 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-0, foobarTopic-1
2023-10-24 | 10:34:19.413 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-2
2023-10-24 | 10:34:19.413 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:19.413 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:19.413 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:19.414 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Cluster ID: DiKCfE60Ql66Mrsd8YBHIA
2023-10-24 | 10:34:19.414 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$FindCoordinatorResponseHandler.java:853) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Discovered group coordinator localhost:50643 (id: 2147483647 rack: null)
2023-10-24 | 10:34:19.414 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator$OffsetFetchResponseHandler.java:1405) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Found no committed offset for partition foobarTopic-1
2023-10-24 | 10:34:19.414 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator$OffsetFetchResponseHandler.java:1405) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Found no committed offset for partition foobarTopic-2
2023-10-24 | 10:34:19.415 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Setting offset for partition foobarTopic-0 to the committed offset FetchPosition{offset=2, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:34:19.415 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:19.424 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.SubscriptionState (SubscriptionState.java:398) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Resetting offset for partition foobarTopic-2 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}.
2023-10-24 | 10:34:19.431 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.SubscriptionState (SubscriptionState.java:398) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Resetting offset for partition foobarTopic-1 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}.
2023-10-24 | 10:34:19.433 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Request joining group due to: need to re-join with the given member-id
2023-10-24 | 10:34:19.434 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:19.436 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 0:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:34:19.435 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 2:0
The Key is null
1
2023-10-24 | 10:34:19.442 | ERROR | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | route2 (CamelLogger.java:163) | Having an unretryable issue due to NON RETRY ERROR TRIGGERED BY TEST
2023-10-24 | 10:34:19.442 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:132) | Unhandled exception on message from Kafka - will not retry
Message consumed from foobarTopic
The Partion:Offset is 0:2
The Key is null
2023-10-24 | 10:34:19.442 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 2:0
The Key is null
1
2023-10-24 | 10:34:19.443 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 0:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:34:19.453 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 2:1
The Key is null
3
2023-10-24 | 10:34:19.454 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 2:1
The Key is null
3
2023-10-24 | 10:34:19.456 | ERROR | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.c.p.e.DefaultErrorHandler (CamelLogger.java:205) | Failed delivery for (MessageId: E1DCA3D2ADF9E86-0000000000000001 on ExchangeId: E1DCA3D2ADF9E86-0000000000000001). Exhausted after delivery attempt: 1 caught: codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST. Processed by failure processor: FatalFallbackErrorHandler[null]

Message History (source location and message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
Source                                   ID                             Processor                                          Elapsed (ms)
                                         route2/route2                  from[kafka://foobarTopic?allowManualCommit=true&au    344093964

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:34:19.457 | WARN  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:131) | Error during processing Exchange[E1DCA3D2ADF9E86-0000000000000001] from topic: foobarTopic
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:34:19.460 | WARN  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:132) | Will seek consumer to offset -1 and start polling again.
2023-10-24 | 10:34:19.463 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-0, foobarTopic-1
2023-10-24 | 10:34:19.464 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1060) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Member consumer-test_group_id-1-99e5ea8f-8a53-4e16-86ab-8b53b886a991 sending LeaveGroup request to coordinator localhost:50643 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2023-10-24 | 10:34:19.465 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:19.466 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:19.469 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:1075) | [Consumer clientId=consumer-test_group_id-1, groupId=test_group_id] Unsubscribed all topics or patterns and assigned partitions
2023-10-24 | 10:34:19.469 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 2:2
The Key is null
5
2023-10-24 | 10:34:19.469 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 2:2
The Key is null
5
2023-10-24 | 10:34:19.478 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:34:19.479 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:34:19.479 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158059478
2023-10-24 | 10:34:19.480 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:966) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Subscribed to topic(s): foobarTopic
2023-10-24 | 10:34:19.480 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 2:3
The Key is null
6
2023-10-24 | 10:34:19.480 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 2:3
The Key is null
6
2023-10-24 | 10:34:19.497 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 2:4
The Key is null
9
2023-10-24 | 10:34:19.498 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 2:4
The Key is null
9
2023-10-24 | 10:34:19.499 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:19.500 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:19.500 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:19.505 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Cluster ID: DiKCfE60Ql66Mrsd8YBHIA
2023-10-24 | 10:34:19.507 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$FindCoordinatorResponseHandler.java:853) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Discovered group coordinator localhost:50643 (id: 2147483647 rack: null)
2023-10-24 | 10:34:19.508 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:19.516 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 2:5
The Key is null
11
2023-10-24 | 10:34:19.519 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 2:5
The Key is null
11
2023-10-24 | 10:34:19.520 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Request joining group due to: need to re-join with the given member-id
2023-10-24 | 10:34:19.522 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:22.398 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Request joining group due to: group is already rebalancing
2023-10-24 | 10:34:22.403 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-2
2023-10-24 | 10:34:22.405 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:22.426 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Successfully joined group with generation Generation{generationId=3, memberId='consumer-test_group_id-5-5d305ab9-2429-4ff4-8304-c7edc2da66ca', protocol='range'}
2023-10-24 | 10:34:22.426 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Successfully joined group with generation Generation{generationId=3, memberId='consumer-test_group_id-2-c356c099-325d-430b-a023-d00551776ddd', protocol='range'}
2023-10-24 | 10:34:22.426 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Successfully joined group with generation Generation{generationId=3, memberId='consumer-test_group_id-4-6b2412f0-6a5e-4ba6-bc54-05aaf76bd9ca', protocol='range'}
2023-10-24 | 10:34:22.434 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:659) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Finished assignment for group at generation 3: {consumer-test_group_id-5-5d305ab9-2429-4ff4-8304-c7edc2da66ca=Assignment(partitions=[foobarTopic-2]), consumer-test_group_id-4-6b2412f0-6a5e-4ba6-bc54-05aaf76bd9ca=Assignment(partitions=[foobarTopic-1]), consumer-test_group_id-2-c356c099-325d-430b-a023-d00551776ddd=Assignment(partitions=[foobarTopic-0])}
2023-10-24 | 10:34:22.462 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Successfully synced group in generation Generation{generationId=3, memberId='consumer-test_group_id-5-5d305ab9-2429-4ff4-8304-c7edc2da66ca', protocol='range'}
2023-10-24 | 10:34:22.462 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Successfully synced group in generation Generation{generationId=3, memberId='consumer-test_group_id-4-6b2412f0-6a5e-4ba6-bc54-05aaf76bd9ca', protocol='range'}
2023-10-24 | 10:34:22.462 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Successfully synced group in generation Generation{generationId=3, memberId='consumer-test_group_id-2-c356c099-325d-430b-a023-d00551776ddd', protocol='range'}
2023-10-24 | 10:34:22.463 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-2])
2023-10-24 | 10:34:22.464 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-1])
2023-10-24 | 10:34:22.466 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-0])
2023-10-24 | 10:34:22.470 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-2
2023-10-24 | 10:34:22.470 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-1
2023-10-24 | 10:34:22.470 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-0
2023-10-24 | 10:34:22.474 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator$OffsetFetchResponseHandler.java:1405) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Found no committed offset for partition foobarTopic-1
2023-10-24 | 10:34:22.474 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Setting offset for partition foobarTopic-2 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:34:22.475 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Setting offset for partition foobarTopic-0 to the committed offset FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:34:22.499 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.SubscriptionState (SubscriptionState.java:398) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Resetting offset for partition foobarTopic-1 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}.
2023-10-24 | 10:34:22.506 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 1:0
The Key is null
7
2023-10-24 | 10:34:22.506 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 1:0
The Key is null
7
2023-10-24 | 10:34:22.517 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 1:1
The Key is null
8
2023-10-24 | 10:34:22.518 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 1:1
The Key is null
8
2023-10-24 | 10:34:22.687 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 0:3
The Key is null
NORETRY-ERROR
2023-10-24 | 10:34:22.688 | ERROR | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | route2 (CamelLogger.java:163) | Having an unretryable issue due to NON RETRY ERROR TRIGGERED BY TEST
2023-10-24 | 10:34:22.689 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:132) | Unhandled exception on message from Kafka - will not retry
Message consumed from foobarTopic
The Partion:Offset is 0:3
The Key is null
2023-10-24 | 10:34:22.695 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 0:3
The Key is null
NORETRY-ERROR
2023-10-24 | 10:34:22.707 | ERROR | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.c.p.e.DefaultErrorHandler (CamelLogger.java:205) | Failed delivery for (MessageId: E1DCA3D2ADF9E86-0000000000000002 on ExchangeId: E1DCA3D2ADF9E86-0000000000000002). Exhausted after delivery attempt: 1 caught: codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST. Processed by failure processor: FatalFallbackErrorHandler[null]

Message History (source location and message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
Source                                   ID                             Processor                                          Elapsed (ms)
                                         route2/route2                  from[kafka://foobarTopic?allowManualCommit=true&au    344097216

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:34:22.709 | WARN  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:131) | Error during processing Exchange[E1DCA3D2ADF9E86-0000000000000002] from topic: foobarTopic
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:34:22.710 | WARN  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:132) | Will seek consumer to offset 5 and start polling again.
2023-10-24 | 10:34:22.715 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-0
2023-10-24 | 10:34:22.715 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1060) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Member consumer-test_group_id-2-c356c099-325d-430b-a023-d00551776ddd sending LeaveGroup request to coordinator localhost:50643 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2023-10-24 | 10:34:22.716 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:22.716 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:22.716 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:1075) | [Consumer clientId=consumer-test_group_id-2, groupId=test_group_id] Unsubscribed all topics or patterns and assigned partitions
2023-10-24 | 10:34:22.726 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:34:22.726 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:34:22.726 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158062726
2023-10-24 | 10:34:22.727 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:966) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Subscribed to topic(s): foobarTopic
2023-10-24 | 10:34:22.739 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:22.739 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:22.739 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:22.740 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Cluster ID: DiKCfE60Ql66Mrsd8YBHIA
2023-10-24 | 10:34:22.740 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$FindCoordinatorResponseHandler.java:853) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Discovered group coordinator localhost:50643 (id: 2147483647 rack: null)
2023-10-24 | 10:34:22.741 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:22.753 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Request joining group due to: need to re-join with the given member-id
2023-10-24 | 10:34:22.753 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:25.451 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Request joining group due to: group is already rebalancing
2023-10-24 | 10:34:25.451 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Request joining group due to: group is already rebalancing
2023-10-24 | 10:34:25.453 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-2
2023-10-24 | 10:34:25.454 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:25.454 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-1
2023-10-24 | 10:34:25.454 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:25.470 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Successfully joined group with generation Generation{generationId=4, memberId='consumer-test_group_id-5-5d305ab9-2429-4ff4-8304-c7edc2da66ca', protocol='range'}
2023-10-24 | 10:34:25.474 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Successfully joined group with generation Generation{generationId=4, memberId='consumer-test_group_id-4-6b2412f0-6a5e-4ba6-bc54-05aaf76bd9ca', protocol='range'}
2023-10-24 | 10:34:25.476 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:659) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Finished assignment for group at generation 4: {consumer-test_group_id-5-5d305ab9-2429-4ff4-8304-c7edc2da66ca=Assignment(partitions=[foobarTopic-1]), consumer-test_group_id-4-6b2412f0-6a5e-4ba6-bc54-05aaf76bd9ca=Assignment(partitions=[foobarTopic-0]), consumer-test_group_id-6-714ac0a0-74b0-44e6-b4f3-1b28833f9c4a=Assignment(partitions=[foobarTopic-2])}
2023-10-24 | 10:34:25.476 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Successfully joined group with generation Generation{generationId=4, memberId='consumer-test_group_id-6-714ac0a0-74b0-44e6-b4f3-1b28833f9c4a', protocol='range'}
2023-10-24 | 10:34:25.487 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Successfully synced group in generation Generation{generationId=4, memberId='consumer-test_group_id-4-6b2412f0-6a5e-4ba6-bc54-05aaf76bd9ca', protocol='range'}
2023-10-24 | 10:34:25.487 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Successfully synced group in generation Generation{generationId=4, memberId='consumer-test_group_id-5-5d305ab9-2429-4ff4-8304-c7edc2da66ca', protocol='range'}
2023-10-24 | 10:34:25.494 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-0])
2023-10-24 | 10:34:25.494 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Successfully synced group in generation Generation{generationId=4, memberId='consumer-test_group_id-6-714ac0a0-74b0-44e6-b4f3-1b28833f9c4a', protocol='range'}
2023-10-24 | 10:34:25.494 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-1])
2023-10-24 | 10:34:25.494 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-1
2023-10-24 | 10:34:25.494 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-0
2023-10-24 | 10:34:25.495 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-2])
2023-10-24 | 10:34:25.495 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-2
2023-10-24 | 10:34:25.497 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Setting offset for partition foobarTopic-2 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:34:25.497 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Setting offset for partition foobarTopic-1 to the committed offset FetchPosition{offset=2, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:34:25.498 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Setting offset for partition foobarTopic-0 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:34:25.610 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.consumer.internals.Fetcher (Fetcher.java:1413) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Fetch position FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}} is out of range for partition foobarTopic-0, resetting offset
2023-10-24 | 10:34:25.617 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.SubscriptionState (SubscriptionState.java:398) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Resetting offset for partition foobarTopic-0 to position FetchPosition{offset=0, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}.
2023-10-24 | 10:34:25.623 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 0:0
The Key is null
2
2023-10-24 | 10:34:25.624 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 0:0
The Key is null
2
2023-10-24 | 10:34:25.634 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 0:1
The Key is null
4
2023-10-24 | 10:34:25.636 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 0:1
The Key is null
4
2023-10-24 | 10:34:25.643 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 0:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:34:25.644 | ERROR | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | route2 (CamelLogger.java:163) | Having an unretryable issue due to NON RETRY ERROR TRIGGERED BY TEST
2023-10-24 | 10:34:25.644 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:132) | Unhandled exception on message from Kafka - will not retry
Message consumed from foobarTopic
The Partion:Offset is 0:2
The Key is null
2023-10-24 | 10:34:25.645 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 0:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:34:25.651 | ERROR | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.c.p.e.DefaultErrorHandler (CamelLogger.java:205) | Failed delivery for (MessageId: E1DCA3D2ADF9E86-0000000000000003 on ExchangeId: E1DCA3D2ADF9E86-0000000000000003). Exhausted after delivery attempt: 1 caught: codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST. Processed by failure processor: FatalFallbackErrorHandler[null]

Message History (source location and message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
Source                                   ID                             Processor                                          Elapsed (ms)
                                         route2/route2                  from[kafka://foobarTopic?allowManualCommit=true&au    344100160

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:34:25.651 | WARN  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:131) | Error during processing Exchange[E1DCA3D2ADF9E86-0000000000000003] from topic: foobarTopic
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:34:25.652 | WARN  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:132) | Will seek consumer to offset 1 and start polling again.
2023-10-24 | 10:34:25.655 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-0
2023-10-24 | 10:34:25.656 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1060) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Member consumer-test_group_id-4-6b2412f0-6a5e-4ba6-bc54-05aaf76bd9ca sending LeaveGroup request to coordinator localhost:50643 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2023-10-24 | 10:34:25.656 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:25.656 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:25.657 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:1075) | [Consumer clientId=consumer-test_group_id-4, groupId=test_group_id] Unsubscribed all topics or patterns and assigned partitions
2023-10-24 | 10:34:25.663 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:34:25.664 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:34:25.664 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158065663
2023-10-24 | 10:34:25.665 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:966) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Subscribed to topic(s): foobarTopic
2023-10-24 | 10:34:25.673 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:25.676 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:25.677 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:25.677 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Cluster ID: DiKCfE60Ql66Mrsd8YBHIA
2023-10-24 | 10:34:25.678 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$FindCoordinatorResponseHandler.java:853) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Discovered group coordinator localhost:50643 (id: 2147483647 rack: null)
2023-10-24 | 10:34:25.680 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:25.691 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Request joining group due to: need to re-join with the given member-id
2023-10-24 | 10:34:25.692 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:28.474 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Request joining group due to: group is already rebalancing
2023-10-24 | 10:34:28.475 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-1
2023-10-24 | 10:34:28.475 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:28.479 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Request joining group due to: group is already rebalancing
2023-10-24 | 10:34:28.480 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-2
2023-10-24 | 10:34:28.480 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:28.485 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Successfully joined group with generation Generation{generationId=5, memberId='consumer-test_group_id-5-5d305ab9-2429-4ff4-8304-c7edc2da66ca', protocol='range'}
2023-10-24 | 10:34:28.485 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Successfully joined group with generation Generation{generationId=5, memberId='consumer-test_group_id-6-714ac0a0-74b0-44e6-b4f3-1b28833f9c4a', protocol='range'}
2023-10-24 | 10:34:28.485 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Successfully joined group with generation Generation{generationId=5, memberId='consumer-test_group_id-7-75b0b87c-6b89-4176-b856-b6f56d8fc551', protocol='range'}
2023-10-24 | 10:34:28.488 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:659) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Finished assignment for group at generation 5: {consumer-test_group_id-5-5d305ab9-2429-4ff4-8304-c7edc2da66ca=Assignment(partitions=[foobarTopic-0]), consumer-test_group_id-7-75b0b87c-6b89-4176-b856-b6f56d8fc551=Assignment(partitions=[foobarTopic-2]), consumer-test_group_id-6-714ac0a0-74b0-44e6-b4f3-1b28833f9c4a=Assignment(partitions=[foobarTopic-1])}
2023-10-24 | 10:34:28.502 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Successfully synced group in generation Generation{generationId=5, memberId='consumer-test_group_id-7-75b0b87c-6b89-4176-b856-b6f56d8fc551', protocol='range'}
2023-10-24 | 10:34:28.503 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Successfully synced group in generation Generation{generationId=5, memberId='consumer-test_group_id-5-5d305ab9-2429-4ff4-8304-c7edc2da66ca', protocol='range'}
2023-10-24 | 10:34:28.503 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-2])
2023-10-24 | 10:34:28.503 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-0])
2023-10-24 | 10:34:28.504 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-2
2023-10-24 | 10:34:28.504 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-0
2023-10-24 | 10:34:28.505 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Successfully synced group in generation Generation{generationId=5, memberId='consumer-test_group_id-6-714ac0a0-74b0-44e6-b4f3-1b28833f9c4a', protocol='range'}
2023-10-24 | 10:34:28.505 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-1])
2023-10-24 | 10:34:28.505 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-1
2023-10-24 | 10:34:28.510 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Setting offset for partition foobarTopic-1 to the committed offset FetchPosition{offset=2, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:34:28.510 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Setting offset for partition foobarTopic-2 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:34:28.510 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Setting offset for partition foobarTopic-0 to the committed offset FetchPosition{offset=2, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:34:28.660 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:147) | Message consumed from Kafka
Message consumed from foobarTopic
The Partion:Offset is 0:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:34:28.661 | ERROR | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | route2 (CamelLogger.java:163) | Having an unretryable issue due to NON RETRY ERROR TRIGGERED BY TEST
2023-10-24 | 10:34:28.662 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:132) | Unhandled exception on message from Kafka - will not retry
Message consumed from foobarTopic
The Partion:Offset is 0:2
The Key is null
2023-10-24 | 10:34:28.662 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | c.c.k.KafkaOffsetManagerProcessor (KafkaOffsetManagerProcessor.java:49) | manually committing the offset for batch
Message consumed from foobarTopic
The Partion:Offset is 0:2
The Key is null
NORETRY-ERROR
2023-10-24 | 10:34:28.667 | ERROR | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.c.p.e.DefaultErrorHandler (CamelLogger.java:205) | Failed delivery for (MessageId: E1DCA3D2ADF9E86-0000000000000004 on ExchangeId: E1DCA3D2ADF9E86-0000000000000004). Exhausted after delivery attempt: 1 caught: codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST. Processed by failure processor: FatalFallbackErrorHandler[null]

Message History (source location and message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
Source                                   ID                             Processor                                          Elapsed (ms)
                                         route2/route2                  from[kafka://foobarTopic?allowManualCommit=true&au    344103176

Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:34:28.668 | WARN  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:131) | Error during processing Exchange[E1DCA3D2ADF9E86-0000000000000004] from topic: foobarTopic
codesmell.exception.NonRetryException: NON RETRY ERROR TRIGGERED BY TEST
	at codesmell.test.CamelKafkaOffsetTest.ifIsPayloadWithErrorThrowException(CamelKafkaOffsetTest.java:165)
	at org.apache.camel.support.processor.DelegateSyncProcessor.process(DelegateSyncProcessor.java:65)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:829)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:737)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.impl.engine.DefaultAsyncProcessorAwaitManager.process(DefaultAsyncProcessorAwaitManager.java:83)
	at org.apache.camel.support.AsyncProcessorSupport.process(AsyncProcessorSupport.java:41)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessor.processExchange(KafkaRecordProcessor.java:110)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processRecord(KafkaRecordProcessorFacade.java:125)
	at org.apache.camel.component.kafka.consumer.support.KafkaRecordProcessorFacade.processPolledRecords(KafkaRecordProcessorFacade.java:78)
	at org.apache.camel.component.kafka.KafkaFetchRecords.startPolling(KafkaFetchRecords.java:328)
	at org.apache.camel.component.kafka.KafkaFetchRecords.run(KafkaFetchRecords.java:160)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
2023-10-24 | 10:34:28.668 | WARN  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.c.c.k.c.s.KafkaRecordProcessor (KafkaRecordProcessor.java:132) | Will seek consumer to offset -1 and start polling again.
2023-10-24 | 10:34:28.668 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-0
2023-10-24 | 10:34:28.669 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1060) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Member consumer-test_group_id-5-5d305ab9-2429-4ff4-8304-c7edc2da66ca sending LeaveGroup request to coordinator localhost:50643 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2023-10-24 | 10:34:28.669 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:28.669 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:28.669 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:1075) | [Consumer clientId=consumer-test_group_id-5, groupId=test_group_id] Unsubscribed all topics or patterns and assigned partitions
2023-10-24 | 10:34:28.676 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:119) | Kafka version: 3.1.2
2023-10-24 | 10:34:28.676 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:120) | Kafka commitId: f8c67dc3ae0a3265
2023-10-24 | 10:34:28.676 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser$AppInfo.java:121) | Kafka startTimeMs: 1698158068676
2023-10-24 | 10:34:28.676 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:966) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Subscribed to topic(s): foobarTopic
2023-10-24 | 10:34:28.684 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-0 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:28.684 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-2 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:28.685 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:402) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Resetting the last seen epoch of partition foobarTopic-1 to 0 since the associated topicId changed from null to -U0gYTY6TfWIrzCXqxAZFg
2023-10-24 | 10:34:28.685 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | org.apache.kafka.clients.Metadata (Metadata.java:287) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Cluster ID: DiKCfE60Ql66Mrsd8YBHIA
2023-10-24 | 10:34:28.686 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$FindCoordinatorResponseHandler.java:853) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Discovered group coordinator localhost:50643 (id: 2147483647 rack: null)
2023-10-24 | 10:34:28.689 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:28.699 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Request joining group due to: need to re-join with the given member-id
2023-10-24 | 10:34:28.700 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:29.111 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: NORETRY-ERROR 5 times
2023-10-24 | 10:34:29.111 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 2 2 times
2023-10-24 | 10:34:29.112 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 4 2 times
2023-10-24 | 10:34:29.112 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 11 1 times
2023-10-24 | 10:34:29.112 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 1 1 times
2023-10-24 | 10:34:29.112 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 3 1 times
2023-10-24 | 10:34:29.112 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 5 1 times
2023-10-24 | 10:34:29.112 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 6 1 times
2023-10-24 | 10:34:29.112 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 7 1 times
2023-10-24 | 10:34:29.112 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 8 1 times
2023-10-24 | 10:34:29.112 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (CamelKafkaOffsetTest.java:197) | Consumed Key: 9 1 times
2023-10-24 | 10:34:29.203 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (StopWatchTestExecutionListener.java:64) | ********************************************************************************
2023-10-24 | 10:34:29.203 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (StopWatchTestExecutionListener.java:65) | Testing done: offsetRestIncorrectlyOnRejoin (codesmell.test.CamelKafkaOffsetTest)
2023-10-24 | 10:34:29.203 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (StopWatchTestExecutionListener.java:66) | Took: 12s0ms (12000 millis)
2023-10-24 | 10:34:29.204 | INFO  | [main] | codesmell.test.CamelKafkaOffsetTest (StopWatchTestExecutionListener.java:67) | ********************************************************************************
2023-10-24 | 10:34:30.134 | INFO  | [Camel (camel-1) thread #14 - ShutdownTask] | o.a.kafka.common.metrics.Metrics (Metrics.java:659) | Metrics scheduler closed
2023-10-24 | 10:34:30.136 | INFO  | [Camel (camel-1) thread #14 - ShutdownTask] | o.a.kafka.common.metrics.Metrics (Metrics.java:663) | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2023-10-24 | 10:34:30.137 | INFO  | [Camel (camel-1) thread #14 - ShutdownTask] | o.a.kafka.common.metrics.Metrics (Metrics.java:669) | Metrics reporters closed
2023-10-24 | 10:34:30.143 | INFO  | [Camel (camel-1) thread #14 - ShutdownTask] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser.java:83) | App info kafka.producer for producer-1 unregistered
2023-10-24 | 10:34:30.669 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-2
2023-10-24 | 10:34:30.671 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1060) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Member consumer-test_group_id-7-75b0b87c-6b89-4176-b856-b6f56d8fc551 sending LeaveGroup request to coordinator localhost:50643 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2023-10-24 | 10:34:30.673 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:30.673 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:30.674 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:1075) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Unsubscribed all topics or patterns and assigned partitions
2023-10-24 | 10:34:30.677 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:30.677 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-7, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:30.682 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.metrics.Metrics (Metrics.java:659) | Metrics scheduler closed
2023-10-24 | 10:34:30.683 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.metrics.Metrics (Metrics.java:663) | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2023-10-24 | 10:34:30.683 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.metrics.Metrics (Metrics.java:669) | Metrics reporters closed
2023-10-24 | 10:34:30.691 | INFO  | [Camel (camel-1) thread #2 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser.java:83) | App info kafka.consumer for consumer-test_group_id-7 unregistered
2023-10-24 | 10:34:31.493 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Request joining group due to: group is already rebalancing
2023-10-24 | 10:34:31.494 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-1
2023-10-24 | 10:34:31.494 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:535) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] (Re-)joining group
2023-10-24 | 10:34:31.507 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Successfully joined group with generation Generation{generationId=6, memberId='consumer-test_group_id-6-714ac0a0-74b0-44e6-b4f3-1b28833f9c4a', protocol='range'}
2023-10-24 | 10:34:31.507 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$JoinGroupResponseHandler.java:595) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Successfully joined group with generation Generation{generationId=6, memberId='consumer-test_group_id-8-828d5a70-7eb2-4b6d-aa35-84f2d431765c', protocol='range'}
2023-10-24 | 10:34:31.511 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:659) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Finished assignment for group at generation 6: {consumer-test_group_id-6-714ac0a0-74b0-44e6-b4f3-1b28833f9c4a=Assignment(partitions=[foobarTopic-0, foobarTopic-1]), consumer-test_group_id-8-828d5a70-7eb2-4b6d-aa35-84f2d431765c=Assignment(partitions=[foobarTopic-2])}
2023-10-24 | 10:34:31.530 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Successfully synced group in generation Generation{generationId=6, memberId='consumer-test_group_id-8-828d5a70-7eb2-4b6d-aa35-84f2d431765c', protocol='range'}
2023-10-24 | 10:34:31.530 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator$SyncGroupResponseHandler.java:761) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Successfully synced group in generation Generation{generationId=6, memberId='consumer-test_group_id-6-714ac0a0-74b0-44e6-b4f3-1b28833f9c4a', protocol='range'}
2023-10-24 | 10:34:31.531 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-0, foobarTopic-1])
2023-10-24 | 10:34:31.531 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:280) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Notifying assignor about the new Assignment(partitions=[foobarTopic-2])
2023-10-24 | 10:34:31.531 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-0, foobarTopic-1
2023-10-24 | 10:34:31.531 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:292) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Adding newly assigned partitions: foobarTopic-2
2023-10-24 | 10:34:31.535 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Setting offset for partition foobarTopic-2 to the committed offset FetchPosition{offset=6, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:34:31.535 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Setting offset for partition foobarTopic-0 to the committed offset FetchPosition{offset=3, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:34:31.537 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:851) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Setting offset for partition foobarTopic-1 to the committed offset FetchPosition{offset=2, offsetEpoch=Optional.empty, currentLeader=LeaderAndEpoch{leader=Optional[localhost:50643 (id: 0 rack: null)], epoch=0}}
2023-10-24 | 10:34:31.658 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-0, foobarTopic-1
2023-10-24 | 10:34:31.659 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1060) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Member consumer-test_group_id-6-714ac0a0-74b0-44e6-b4f3-1b28833f9c4a sending LeaveGroup request to coordinator localhost:50643 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2023-10-24 | 10:34:31.659 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:31.659 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:31.659 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:1075) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Unsubscribed all topics or patterns and assigned partitions
2023-10-24 | 10:34:31.659 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:31.659 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-6, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:31.660 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.metrics.Metrics (Metrics.java:659) | Metrics scheduler closed
2023-10-24 | 10:34:31.660 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.metrics.Metrics (Metrics.java:663) | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2023-10-24 | 10:34:31.660 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.metrics.Metrics (Metrics.java:669) | Metrics reporters closed
2023-10-24 | 10:34:31.669 | INFO  | [Camel (camel-1) thread #1 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser.java:83) | App info kafka.consumer for consumer-test_group_id-6 unregistered
2023-10-24 | 10:34:33.680 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (ConsumerCoordinator.java:311) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Revoke previously assigned partitions foobarTopic-2
2023-10-24 | 10:34:33.684 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1060) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Member consumer-test_group_id-8-828d5a70-7eb2-4b6d-aa35-84f2d431765c sending LeaveGroup request to coordinator localhost:50643 (id: 2147483647 rack: null) due to the consumer unsubscribed from all topics
2023-10-24 | 10:34:33.690 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:33.690 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:33.691 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.clients.consumer.KafkaConsumer (KafkaConsumer.java:1075) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Unsubscribed all topics or patterns and assigned partitions
2023-10-24 | 10:34:33.691 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:972) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Resetting generation due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:33.700 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.k.c.c.i.ConsumerCoordinator (AbstractCoordinator.java:1000) | [Consumer clientId=consumer-test_group_id-8, groupId=test_group_id] Request joining group due to: consumer pro-actively leaving the group
2023-10-24 | 10:34:33.719 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.metrics.Metrics (Metrics.java:659) | Metrics scheduler closed
2023-10-24 | 10:34:33.719 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.metrics.Metrics (Metrics.java:663) | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2023-10-24 | 10:34:33.719 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.metrics.Metrics (Metrics.java:669) | Metrics reporters closed
2023-10-24 | 10:34:33.725 | INFO  | [Camel (camel-1) thread #3 - KafkaConsumer[foobarTopic]] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser.java:83) | App info kafka.consumer for consumer-test_group_id-8 unregistered
2023-10-24 | 10:34:33.778 | INFO  | [SpringContextShutdownHook] | k.c.ZkNodeChangeNotificationListener$ChangeEventProcessThread (Logging.java:66) | [/config/changes-event-process-thread]: Shutting down
2023-10-24 | 10:34:33.779 | INFO  | [/config/changes-event-process-thread] | k.c.ZkNodeChangeNotificationListener$ChangeEventProcessThread (Logging.java:66) | [/config/changes-event-process-thread]: Stopped
2023-10-24 | 10:34:33.779 | INFO  | [SpringContextShutdownHook] | k.c.ZkNodeChangeNotificationListener$ChangeEventProcessThread (Logging.java:66) | [/config/changes-event-process-thread]: Shutdown completed
2023-10-24 | 10:34:38.036 | INFO  | [SpringContextShutdownHook] | o.a.kafka.common.metrics.Metrics (Metrics.java:659) | Metrics scheduler closed
2023-10-24 | 10:34:38.037 | INFO  | [SpringContextShutdownHook] | o.a.kafka.common.metrics.Metrics (Metrics.java:663) | Closing reporter org.apache.kafka.common.metrics.JmxReporter
2023-10-24 | 10:34:38.038 | INFO  | [SpringContextShutdownHook] | o.a.kafka.common.metrics.Metrics (Metrics.java:669) | Metrics reporters closed
2023-10-24 | 10:34:38.043 | INFO  | [SpringContextShutdownHook] | o.a.kafka.common.utils.AppInfoParser (AppInfoParser.java:83) | App info kafka.server for 0 unregistered
